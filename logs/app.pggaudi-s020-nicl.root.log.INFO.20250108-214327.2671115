I0108 21:43:27.636245 139913156397056 opt.py:30] M: 0
N: 0
accumulation_steps: 1
adam_beta1: 0.9
adam_beta2: 0.95
adam_eps: 1.0e-08
batch_size: 8
cache_dir: llm_weights
epochs: 10
eval_zero_shot: false
infer_batch_size: 1
learning_rate: 0.0002
lr_scheduler: linear
max_grad_norm: 1000.0
model: facebook/opt-125m
nsamples: 256
prune_method: wanda
seed: 0
self_nsamples: 0
seqlen: 1024
sparsity_ratio: 0.5
sparsity_type: unstructured
use_cr: false
use_fp32: true
use_gp: false
warmup_steps: 0
weight_decay: 0.0

I0108 21:43:27.638849 139913156397056 opt.py:40] loading llm model facebook/opt-125m
I0108 21:43:28.821749 139913156397056 opt.py:48] use device cuda:0
I0108 21:43:28.822032 139913156397056 opt.py:50] pruning starts
I0108 21:43:55.367323 139913156397056 prune.py:207] pruning layer 0
I0108 21:43:58.008213 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:44:08.613869 139913156397056 finetune.py:123] [0.0007107183337211609, 0.0001602768898010254, 8.621811866760254e-05, 7.352232933044434e-05, 6.801635026931763e-05, 6.4849853515625e-05, 6.274133920669556e-05, 6.114691495895386e-05, 5.945563316345215e-05, 5.858391523361206e-05, 5.809962749481201e-05]
I0108 21:44:08.614413 139913156397056 prune.py:304] reconstruction time 11.618679761886597
I0108 21:44:09.420289 139913156397056 prune.py:310] recon error 5.790591239929199e-05
I0108 21:44:10.190769 139913156397056 prune.py:207] pruning layer 1
I0108 21:44:12.871585 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:44:23.006594 139913156397056 finetune.py:123] [9.057857096195221e-05, 4.763156175613403e-05, 3.215670585632324e-05, 2.8446316719055176e-05, 2.6345252990722656e-05, 2.512335777282715e-05, 2.4065375328063965e-05, 2.3417174816131592e-05, 2.2921711206436157e-05, 2.2567808628082275e-05, 2.2370368242263794e-05]
I0108 21:44:23.007078 139913156397056 prune.py:304] reconstruction time 10.953697204589844
I0108 21:44:23.805843 139913156397056 prune.py:310] recon error 9.051058441400528e-05
I0108 21:44:24.573793 139913156397056 prune.py:207] pruning layer 2
I0108 21:44:26.920796 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:44:37.051461 139913156397056 finetune.py:123] [0.00031732022762298584, 0.0001056566834449768, 4.1387975215911865e-05, 3.579258918762207e-05, 3.262609243392944e-05, 3.1128525733947754e-05, 2.985447645187378e-05, 2.8993934392929077e-05, 2.826005220413208e-05, 2.7827918529510498e-05, 2.7552247047424316e-05]
I0108 21:44:37.051936 139913156397056 prune.py:304] reconstruction time 10.935485124588013
I0108 21:44:37.873228 139913156397056 prune.py:310] recon error 0.00013606064021587372
I0108 21:44:38.667949 139913156397056 prune.py:207] pruning layer 3
I0108 21:44:41.262836 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:44:52.240028 139913156397056 finetune.py:123] [7.471907883882523e-05, 4.8704445362091064e-05, 3.5449862480163574e-05, 3.1132251024246216e-05, 2.8874725103378296e-05, 2.6874244213104248e-05, 2.5775283575057983e-05, 2.5082379579544067e-05, 2.442672848701477e-05, 2.4087727069854736e-05, 2.3808330297470093e-05]
I0108 21:44:52.240551 139913156397056 prune.py:304] reconstruction time 11.817017078399658
I0108 21:44:53.062787 139913156397056 prune.py:310] recon error 0.00017842277884483337
I0108 21:44:53.855057 139913156397056 prune.py:207] pruning layer 4
I0108 21:44:56.344841 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:45:06.664290 139913156397056 finetune.py:123] [0.00016804784536361694, 0.00011220574378967285, 8.285045623779297e-05, 7.411837577819824e-05, 6.967782974243164e-05, 6.642192602157593e-05, 6.467103958129883e-05, 6.283074617385864e-05, 6.166845560073853e-05, 6.092339754104614e-05, 6.0424208641052246e-05]
I0108 21:45:06.664804 139913156397056 prune.py:304] reconstruction time 11.167514085769653
I0108 21:45:07.483350 139913156397056 prune.py:310] recon error 0.0002724491059780121
I0108 21:45:08.275423 139913156397056 prune.py:207] pruning layer 5
I0108 21:45:10.712463 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:45:21.110857 139913156397056 finetune.py:123] [0.00027012452483177185, 0.00019249320030212402, 0.00014850497245788574, 0.00013518333435058594, 0.0001280456781387329, 0.00012375414371490479, 0.00012084841728210449, 0.00011873245239257812, 0.00011718273162841797, 0.00011616945266723633, 0.00011548399925231934]
I0108 21:45:21.111377 139913156397056 prune.py:304] reconstruction time 11.246612787246704
I0108 21:45:21.953908 139913156397056 prune.py:310] recon error 0.0004309713840484619
I0108 21:45:22.782185 139913156397056 prune.py:207] pruning layer 6
I0108 21:45:25.300791 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:45:35.739213 139913156397056 finetune.py:123] [0.0003898516297340393, 0.0002751946449279785, 0.00021225214004516602, 0.00019246339797973633, 0.00018212199211120605, 0.00017562508583068848, 0.00017142295837402344, 0.00016838312149047852, 0.00016638636589050293, 0.00016480684280395508, 0.0001639723777770996]
I0108 21:45:35.739690 139913156397056 prune.py:304] reconstruction time 11.291754722595215
I0108 21:45:36.570060 139913156397056 prune.py:310] recon error 0.0006795823574066162
I0108 21:45:37.347817 139913156397056 prune.py:207] pruning layer 7
I0108 21:45:39.747600 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:45:49.973639 139913156397056 finetune.py:123] [0.0005626082420349121, 0.0003952980041503906, 0.00030118227005004883, 0.0002740025520324707, 0.00025853514671325684, 0.00024956464767456055, 0.0002435445785522461, 0.00023922324180603027, 0.00023561716079711914, 0.0002333223819732666, 0.00023192167282104492]
I0108 21:45:49.974098 139913156397056 prune.py:304] reconstruction time 11.064180374145508
I0108 21:45:50.810702 139913156397056 prune.py:310] recon error 0.0010274797677993774
I0108 21:45:51.568826 139913156397056 prune.py:207] pruning layer 8
I0108 21:45:54.021671 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:46:04.291413 139913156397056 finetune.py:123] [0.0009037107229232788, 0.0006539821624755859, 0.0005028843879699707, 0.0004538893699645996, 0.00042891502380371094, 0.00041359663009643555, 0.0004032254219055176, 0.0003959536552429199, 0.0003909468650817871, 0.0003871917724609375, 0.0003846287727355957]
I0108 21:46:04.291840 139913156397056 prune.py:304] reconstruction time 11.093794584274292
I0108 21:46:05.083043 139913156397056 prune.py:310] recon error 0.0017201900482177734
I0108 21:46:05.837616 139913156397056 prune.py:207] pruning layer 9
I0108 21:46:08.267935 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:46:19.571355 139913156397056 finetune.py:123] [0.0015973448753356934, 0.0011669397354125977, 0.0008901357650756836, 0.0007991790771484375, 0.000750422477722168, 0.0007208585739135742, 0.0007007122039794922, 0.0006870031356811523, 0.0006767511367797852, 0.0006693601608276367, 0.0006651878356933594]
I0108 21:46:19.571821 139913156397056 prune.py:304] reconstruction time 12.111128807067871
I0108 21:46:20.372333 139913156397056 prune.py:310] recon error 0.003046572208404541
I0108 21:46:21.136585 139913156397056 prune.py:207] pruning layer 10
I0108 21:46:23.542023 139913156397056 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:46:34.069384 139913156397056 finetune.py:123] [0.002374023199081421, 0.0017597675323486328, 0.001338958740234375, 0.0011985301971435547, 0.001125335693359375, 0.0010786056518554688, 0.0010460615158081055, 0.0010237693786621094, 0.0010075569152832031, 0.0009955167770385742, 0.0009882450103759766]
I0108 21:46:34.069858 139913156397056 prune.py:304] reconstruction time 11.359578132629395
I0108 21:46:34.956176 139913156397056 prune.py:310] recon error 0.005202829837799072
I0108 21:46:35.778035 139913156397056 prune.py:207] pruning layer 11
