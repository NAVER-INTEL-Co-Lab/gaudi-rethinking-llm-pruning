I0108 21:39:32.685059 140706777335808 opt.py:30] M: 0
N: 0
accumulation_steps: 1
adam_beta1: 0.9
adam_beta2: 0.95
adam_eps: 1.0e-08
batch_size: 8
cache_dir: llm_weights
epochs: 10
eval_zero_shot: false
infer_batch_size: 1
learning_rate: 0.0002
lr_scheduler: linear
max_grad_norm: 1000.0
model: facebook/opt-125m
nsamples: 256
prune_method: magnitude
seed: 0
self_nsamples: 0
seqlen: 1024
sparsity_ratio: 0.5
sparsity_type: unstructured
use_cr: false
use_fp32: true
use_gp: false
warmup_steps: 0
weight_decay: 0.0

I0108 21:39:32.687572 140706777335808 opt.py:40] loading llm model facebook/opt-125m
I0108 21:39:33.872288 140706777335808 opt.py:48] use device cuda:0
I0108 21:39:33.872436 140706777335808 opt.py:50] pruning starts
I0108 21:40:01.307899 140706777335808 prune.py:207] pruning layer 0
I0108 21:40:03.105272 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:40:13.522470 140706777335808 finetune.py:123] [0.00027037039399147034, 0.0001627206802368164, 0.0001074373722076416, 8.90195369720459e-05, 8.131563663482666e-05, 7.683038711547852e-05, 7.325410842895508e-05, 7.101893424987793e-05, 6.921589374542236e-05, 6.821751594543457e-05, 6.759166717529297e-05]
I0108 21:40:13.522980 140706777335808 prune.py:304] reconstruction time 11.181223392486572
I0108 21:40:14.553435 140706777335808 prune.py:310] recon error 6.745290011167526e-05
I0108 21:40:15.465828 140706777335808 prune.py:207] pruning layer 1
I0108 21:40:17.373573 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:40:27.553960 140706777335808 finetune.py:123] [0.0004646778106689453, 0.00018543004989624023, 7.463991641998291e-05, 6.010383367538452e-05, 5.3748488426208496e-05, 5.020946264266968e-05, 4.769861698150635e-05, 4.611164331436157e-05, 4.503875970840454e-05, 4.4383108615875244e-05, 4.3973326683044434e-05]
I0108 21:40:27.554448 140706777335808 prune.py:304] reconstruction time 11.018008947372437
I0108 21:40:28.433814 140706777335808 prune.py:310] recon error 0.00012007169425487518
I0108 21:40:29.185668 140706777335808 prune.py:207] pruning layer 2
I0108 21:40:30.945155 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:40:40.765283 140706777335808 finetune.py:123] [0.00023190677165985107, 0.0001049339771270752, 6.407499313354492e-05, 5.4933130741119385e-05, 4.967302083969116e-05, 4.706531763076782e-05, 4.5180320739746094e-05, 4.394352436065674e-05, 4.29302453994751e-05, 4.2378902435302734e-05, 4.203617572784424e-05]
I0108 21:40:40.765611 140706777335808 prune.py:304] reconstruction time 10.587619543075562
I0108 21:40:41.523974 140706777335808 prune.py:310] recon error 0.00018559396266937256
I0108 21:40:42.261467 140706777335808 prune.py:207] pruning layer 3
I0108 21:40:44.799875 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:40:55.427060 140706777335808 finetune.py:123] [0.0001473948359489441, 6.805360317230225e-05, 3.927946090698242e-05, 3.3624470233917236e-05, 3.267824649810791e-05, 2.86102294921875e-05, 2.742186188697815e-05, 2.650916576385498e-05, 2.6036053895950317e-05, 2.5637447834014893e-05, 2.53431499004364e-05]
I0108 21:40:55.427603 140706777335808 prune.py:304] reconstruction time 12.107569932937622
I0108 21:40:56.179899 140706777335808 prune.py:310] recon error 0.00023905932903289795
I0108 21:40:56.911509 140706777335808 prune.py:207] pruning layer 4
I0108 21:40:58.652652 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:41:08.551208 140706777335808 finetune.py:123] [0.000610053539276123, 0.0002582073211669922, 0.000152587890625, 0.0001293867826461792, 0.00011798739433288574, 0.00011152029037475586, 0.00010748207569122314, 0.00010468065738677979, 0.00010284781455993652, 0.00010159611701965332, 0.00010086596012115479]
I0108 21:41:08.551741 140706777335808 prune.py:304] reconstruction time 10.672701597213745
I0108 21:41:09.332033 140706777335808 prune.py:310] recon error 0.0003877878189086914
I0108 21:41:10.090805 140706777335808 prune.py:207] pruning layer 5
I0108 21:41:11.884712 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:41:21.765493 140706777335808 finetune.py:123] [0.0006969720125198364, 0.00036770105361938477, 0.0002506673336029053, 0.00021967291831970215, 0.00020372867584228516, 0.00019478797912597656, 0.0001887977123260498, 0.0001849830150604248, 0.000182420015335083, 0.0001806318759918213, 0.00017967820167541504]
I0108 21:41:21.765998 140706777335808 prune.py:304] reconstruction time 10.667458295822144
I0108 21:41:22.530054 140706777335808 prune.py:310] recon error 0.000629916787147522
I0108 21:41:23.277489 140706777335808 prune.py:207] pruning layer 6
I0108 21:41:25.049513 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:41:34.941452 140706777335808 finetune.py:123] [0.0009675770998001099, 0.0005043148994445801, 0.0003326535224914551, 0.00028818845748901367, 0.00026613473892211914, 0.00025391578674316406, 0.0002461373805999756, 0.0002409219741821289, 0.00023737549781799316, 0.0002352297306060791, 0.0002339780330657959]
I0108 21:41:34.941934 140706777335808 prune.py:304] reconstruction time 10.66429615020752
I0108 21:41:35.704380 140706777335808 prune.py:310] recon error 0.0009874999523162842
I0108 21:41:36.439072 140706777335808 prune.py:207] pruning layer 7
I0108 21:41:38.222451 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:41:48.135058 140706777335808 finetune.py:123] [0.0016219019889831543, 0.0007948875427246094, 0.0004798769950866699, 0.0004088282585144043, 0.0003746151924133301, 0.0003536343574523926, 0.00034058094024658203, 0.00033217668533325195, 0.0003253817558288574, 0.00032138824462890625, 0.000319063663482666]
I0108 21:41:48.135457 140706777335808 prune.py:304] reconstruction time 10.71635365486145
I0108 21:41:48.900316 140706777335808 prune.py:310] recon error 0.0014677941799163818
I0108 21:41:49.653580 140706777335808 prune.py:207] pruning layer 8
I0108 21:41:51.388324 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:42:01.106906 140706777335808 finetune.py:123] [0.002278059720993042, 0.001156926155090332, 0.0007339715957641602, 0.0006260871887207031, 0.0005718469619750977, 0.0005413293838500977, 0.0005221366882324219, 0.0005089044570922852, 0.0005004405975341797, 0.0004946589469909668, 0.0004916191101074219]
I0108 21:42:01.107356 140706777335808 prune.py:304] reconstruction time 10.478980541229248
I0108 21:42:01.878168 140706777335808 prune.py:310] recon error 0.0023825764656066895
I0108 21:42:02.612245 140706777335808 prune.py:207] pruning layer 9
I0108 21:42:04.401906 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:42:15.350374 140706777335808 finetune.py:123] [0.0029070377349853516, 0.0016932487487792969, 0.0011491775512695312, 0.0009968280792236328, 0.0009175539016723633, 0.0008709430694580078, 0.0008417367935180664, 0.0008211135864257812, 0.0008074045181274414, 0.0007985830307006836, 0.0007932186126708984]
I0108 21:42:15.351687 140706777335808 prune.py:304] reconstruction time 11.755582571029663
I0108 21:42:16.124773 140706777335808 prune.py:310] recon error 0.004056394100189209
I0108 21:42:16.863645 140706777335808 prune.py:207] pruning layer 10
I0108 21:42:18.627788 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:42:28.936251 140706777335808 finetune.py:123] [0.0039055943489074707, 0.0024056434631347656, 0.0016858577728271484, 0.0014684200286865234, 0.0013568401336669922, 0.001287698745727539, 0.00124359130859375, 0.0012145042419433594, 0.0011930465698242188, 0.001178741455078125, 0.0011696815490722656]
I0108 21:42:28.936787 140706777335808 prune.py:304] reconstruction time 11.083215713500977
I0108 21:42:29.851229 140706777335808 prune.py:310] recon error 0.006733894348144531
I0108 21:42:30.711992 140706777335808 prune.py:207] pruning layer 11
I0108 21:42:32.774666 140706777335808 finetune.py:129] weight params, number of params: 7087872, weight_decay: 0.0, lr: 0.0002
I0108 21:42:42.742127 140706777335808 finetune.py:123] [0.005942225456237793, 0.0036802291870117188, 0.0024733543395996094, 0.002066373825073242, 0.0018699169158935547, 0.0017518997192382812, 0.001664876937866211, 0.0016083717346191406, 0.0015616416931152344, 0.001531362533569336, 0.001514434814453125]
I0108 21:42:42.742614 140706777335808 prune.py:304] reconstruction time 10.88143253326416
I0108 21:42:43.549333 140706777335808 prune.py:310] recon error 0.01053309440612793
I0108 21:42:44.335960 140706777335808 opt.py:57] ******************************
I0108 21:42:44.341119 140706777335808 prune.py:56] block 0 sparsity 0.500061
I0108 21:42:44.344440 140706777335808 prune.py:56] block 1 sparsity 0.500110
I0108 21:42:44.348284 140706777335808 prune.py:56] block 2 sparsity 0.500103
I0108 21:42:44.351444 140706777335808 prune.py:56] block 3 sparsity 0.500110
I0108 21:42:44.355192 140706777335808 prune.py:56] block 4 sparsity 0.500143
I0108 21:42:44.358343 140706777335808 prune.py:56] block 5 sparsity 0.500164
I0108 21:42:44.363069 140706777335808 prune.py:56] block 6 sparsity 0.500264
I0108 21:42:44.366617 140706777335808 prune.py:56] block 7 sparsity 0.500186
I0108 21:42:44.369621 140706777335808 prune.py:56] block 8 sparsity 0.500085
I0108 21:42:44.372742 140706777335808 prune.py:56] block 9 sparsity 0.500065
I0108 21:42:44.376951 140706777335808 prune.py:56] block 10 sparsity 0.500237
I0108 21:42:44.378832 140706777335808 prune.py:56] block 11 sparsity 0.500227
I0108 21:42:44.378913 140706777335808 opt.py:59] sparsity sanity check 0.5001
I0108 21:42:44.378954 140706777335808 opt.py:60] ******************************
I0108 21:43:13.902271 140706777335808 eval.py:20] Evaluating ...
I0108 21:43:17.565838 140706777335808 eval.py:16] wikitext2 perplexity 36.03786087036133
I0108 21:43:28.713611 140706777335808 eval.py:20] Evaluating ...
I0108 21:43:30.164615 140706777335808 eval.py:16] ptb perplexity 49.190223693847656
I0108 21:43:49.533875 140706777335808 eval.py:20] Evaluating ...
I0108 21:43:56.255096 140706777335808 eval.py:16] c4 perplexity 31.6378231048584
